import{_ as s,c as i,o as a,a2 as t}from"./chunks/framework.CmeiYqq3.js";const g=JSON.parse('{"title":"人机验证说明","description":"","frontmatter":{},"headers":[],"relativePath":"guide/guide/captcha.md","filePath":"guide/guide/captcha.md"}'),h={name:"guide/guide/captcha.md"},e=t(`<h1 id="人机验证说明" tabindex="-1">人机验证说明 <a class="header-anchor" href="#人机验证说明" aria-label="Permalink to &quot;人机验证说明&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">前言</p><p>以下部分简要说明了人机验证流程，使您更容易理解相关功能，或在二次开发中更轻松地引入该功能。</p><p>我们为该项目专门开发了拼图生成库，详细信息请参阅<a href="https://github.com/wangzmgit/jigsaw" target="_blank" rel="noreferrer">jigsaw</a>。</p></div><h2 id="人机验证状态码" tabindex="-1">人机验证状态码 <a class="header-anchor" href="#人机验证状态码" aria-label="Permalink to &quot;人机验证状态码&quot;">​</a></h2><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CAPTCHA_STATUS_ABSENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // 人机验证状态不存在</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CAPTCHA_STATUS_PASS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // 人机验证状态已通过</span></span></code></pre></div><h2 id="返回人机验证状态码" tabindex="-1">返回人机验证状态码 <a class="header-anchor" href="#返回人机验证状态码" aria-label="Permalink to &quot;返回人机验证状态码&quot;">​</a></h2><p>对于需要进行人机验证的相关接口，可以通过以下代码读取人机验证状态。</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GetCaptchaStatus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(captchaId)</span></span></code></pre></div><p>如果人机验证状态不存在，可以通过以下代码，生成<code>captchaId</code>并返回<code>需要人机验证</code>状态</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">captchaId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CreateCaptchaStatus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">resp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">H</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;captchaId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: captchaId}, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;需要人机验证&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>验证通过后，请务必使用以下代码删除当前<code>captchaId</code>的验证状态</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DelCaptchaStatus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(captchaId)</span></span></code></pre></div><h2 id="前端处理验证码" tabindex="-1">前端处理验证码 <a class="header-anchor" href="#前端处理验证码" aria-label="Permalink to &quot;前端处理验证码&quot;">​</a></h2><p>前端通过以下代码引入和使用滑块验证组件，其中<code>v-model:show</code>控制组件的显示和隐藏， <code>captcha-id</code>为后端返回的<code>captchaId</code>，<code>success</code>为验证成功的事件。 用户停止拖动滑块时会将<code>captchaId</code>和<code>滑块的X轴坐标</code>传回后端并进行验证。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SliderCaptcha </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/components/slider-captcha/index.vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slider-captcha</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  v-model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">showCaptcha</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">captcha-id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">captchaId</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">captchaSuccess</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slider-captcha</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div>`,15),p=[e];function n(l,k,d,c,E,o){return a(),i("div",null,p)}const y=s(h,[["render",n]]);export{g as __pageData,y as default};
